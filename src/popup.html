<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
  <title>Web Buddy</title>
    <link
      async
      rel="stylesheet"
      type="text/css"
      href="../vendors/jquery-ui.min.css"
    />
    <link async rel="stylesheet" type="text/css" href="../assets/style.css" />
    <script src="../vendors/jquery-3.3.1.min.js"></script>
    <script src="../vendors/jquery-ui.min.js"></script>
    <script src="../vendors/clipboard-2.0.0.min.js"></script>
    <script src="./logger.js"></script>
    <script src="./pom.js"></script>
  </head>

  <body class="container" tabindex="-1">
    <link rel="stylesheet" type="text/css" href="../assets/popup.css">
  <div class="padding">
      <span>
        <button
          class="btn btn-wide"
          id="record"
          tabindex="-1"
          title="record user action"
        >
          record
        </button>

        <button
          class="btn btn-wide"
          id="resume"
          tabindex="-1"
          title="resume with the recording"
        >
          resume
        </button>

        <button
          class="btn btn-wide"
          id="stop"
          tabindex="-1"
          title="stop the recording"
        >
          stop
        </button>

        <button
          class="btn btn-wide"
          id="pause"
          tabindex="-1"
          title="pause the recording"
        >
          pause
        </button>

        <button
          class="btn btn-wide"
          id="scan"
          tabindex="-1"
          title="scan entire page. might be slow"
        >
          scan
        </button>

        <button
          class="btn btn-wide"
          id="save"
          tabindex="-1"
          disabled
          title="download test script"
        >
          save
        </button>

        <button
          type="button"
          class="btn btn-wide"
          id="run"
          tabindex="-1"
          title="run recorded steps in active tab"
        >
          run
        </button>

        <button
          type="button"
          class="btn btn-wide"
          id="ai-assist"
          tabindex="-1"
          title="Have the AI suggest actions for this page"
        >
          AI Assist
        </button>

        <button
          class="btn btn-wide"
          id="pom"
          tabindex="-1"
          title="open page object model file"
        >
          <!-- creates POM button-->
          pom
        </button>
      </span>

      <span class="btn-thin">
        <button
          class="btn"
          id="copy"
          tabindex="-1"
          title="copy to clipboard"
          data-clipboard-target="#textarea-script"
        ></button>
        <button class="btn" id="open-options" tabindex="-1" title="open options"></button>
          <button class="btn" id="pin" tabindex="-1" title="pin window (keep open)"></button>
  <!-- AI provider badge -->
  <span id="ai-provider-badge">AI: unknown</span>
  <!-- Share UI steps badge -->
  <span id="share-ui-steps-badge">UI Steps: Off</span>
        <button
          class="btn"
          id="settings"
          tabindex="-1"
          title="show/hide settings"
        ></button>
        <button
          class="btn"
          id="info"
          tabindex="-1"
          title="open instructions in another tab"
        ></button>
        <button class="btn" id="like" tabindex="-1" title="like me!"></button>
      </span>
    </div>

    <input id="findme" type="file" style="display: none" />
    <div id="settings-panel" class="pad hidden">
      <div class="panel-row">
        <span>Drag to reorder locators priority</span>
        <ul id="sortable" class="ui-sortable" />
      </div>

      <div class="panel-row">
        <div>
          <input type="checkbox" id="demo" />
          <label for="demo">
            Add a 3s sleep after each action (for demo)
          </label>
        </div>
        <div>
          <input type="checkbox" id="verify" />
          <label for="verify"
            >Check page contains element before performing the action</label
          >
        </div>
      </div>
    </div>

    <div class="pad">
      <textarea
        id="textarea-script"
        tabindex="-1"
        readonly
        title="steps"
      ></textarea>
    </div>
    <div class="pad">
      <div id="mqtt-status" class="small muted">MQTT: unknown</div>
    </div>

    <div class="pad">
      <style>
        /* Simple modern chat styles */
        #chat-window { background: linear-gradient(180deg,#f6f8fb,#eef4fb); border-radius:12px; padding:12px; max-height:220px; overflow:auto; display:flex; flex-direction:column; gap:8px; }
        .chat-bubble { max-width:85%; padding:10px 14px; border-radius:16px; box-shadow:0 2px 6px rgba(10,10,20,0.06); font-size:13px; line-height:1.4; }
        .chat-user { align-self:flex-end; background:linear-gradient(90deg,#4f46e5,#7c3aed); color:#fff; border-bottom-right-radius:6px; }
        .chat-assistant { align-self:flex-start; background:#fff; color:#111; border-bottom-left-radius:6px; }
        .chat-meta { font-size:11px; color:#7b8093; margin-top:4px; }
      </style>

      <label for="chat-input">AI Chat</label>
      <div id="chat-window" aria-live="polite" role="log"></div>
      <textarea id="chat-input" placeholder="Ask the AI..." rows="3"></textarea>
      <div style="margin-top:6px;">
        <label for="site-instructions">Site instructions (editable)</label>
        <textarea id="site-instructions" placeholder="Site-specific hints will appear here if available" rows="3"></textarea>
        <div class="small muted">Instructions are fetched from the current site at <code>/ai-instructions</code> when available, otherwise you can save per-site hints in extension settings.</div>
      </div>
      <div>
        <button class="btn btn-wide" id="chat-send">Send</button>
      </div>
      <div id="chat-response" class="pad small muted">No response yet</div>
      <pre id="chat-raw" class="pad small muted hidden" style="max-height:200px;overflow:auto;white-space:pre-wrap;word-break:break-word;"></pre>
    </div>

    <div class="pad">
      <textarea
        class="hidden"
        id="textarea-log"
        tabindex="-1"
        readonly
      ></textarea>
    </div>

  <script src="popup-helpers.js"></script>
  <script src="popup.js"></script>
  <script src="popup-ai.js"></script>
  <script src="popup-chat.js"></script>
    <div id="keywordDiv">
      <!-- <input type="button"> </input> -->
      <!-- <select id="keywordSelect">
<option>
  asdf
</option>
    </select> -->
    </div>
  </body>
</html>
